<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¤×•×¨×™××•× ×•×¡×˜×œ×’×™×” - ××¢×¨×›×ª ×©×¢×•×ª ××™× ×˜×¨××§×˜×™×‘×™×ª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700;900&display=swap');
        
        body {
            font-family: 'Rubik', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .timeline-card {
            transition: all 0.3s ease;
        }
        .timeline-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .tab-active {
            background-color: white;
            color: #2563eb;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .tab-inactive {
            color: #64748b;
        }
        .tab-inactive:hover {
            color: #334155;
            background-color: rgba(255,255,255,0.5);
        }

        @keyframes pulse-slow {
            0%, 100% { opacity: 1; transform: scale(1.02); }
            50% { opacity: .95; transform: scale(1); }
        }
        .animate-pulse-slow {
            animation: pulse-slow 2.5s ease-in-out infinite;
        }

        /* ×¤×¡ ×”×ª×§×“××•×ª ×× ×›×™ (Timeline) ×œ××©×ª×ª×£ */
        .vertical-timeline::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            right: 1.5rem; /* ~24px */
            width: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            z-index: 0;
        }
        
        @media (max-width: 768px) {
            .vertical-timeline::before {
                right: 1rem;
            }
        }

        /* ×¢×™×¦×•×‘ ×”××¤×” ×”××™× ×˜×¨××§×˜×™×‘×™×ª */
        .map-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
        }
        .map-cell {
            padding: 1rem 0.5rem;
            background-color: #f1f5f9;
            border-radius: 0.75rem;
            border: 2px solid transparent;
            text-align: center;
            font-size: 0.75rem;
            font-weight: 700;
            color: #475569;
            transition: all 0.3s;
        }
        .map-cell.active-loc {
            background-color: #e0e7ff;
            border-color: #6366f1;
            color: #312e81;
            box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.3);
            transform: scale(1.05);
            animation: pulse-slow 2s infinite;
        }

        @media print {
            header, .bg-gradient-to-r, button, select, input[type="range"], .border-b { display: none !important; }
            body { background-color: white !important; padding: 0 !important; }
            .timeline-card { border: 2px solid #cbd5e1 !important; box-shadow: none !important; break-inside: avoid; transform: none !important; }
            #interactive-schedule { box-shadow: none !important; border: none !important; }
            .container { max-width: 100% !important; padding: 0 !important; }
            .vertical-timeline::before { display: none; }
            .map-container { display: none; }
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen flex flex-col font-sans">

    <!-- Header Section -->
    <header class="bg-white shadow-sm sticky top-0 z-50 border-b border-slate-200">
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="text-center md:text-right flex flex-col md:flex-row items-center gap-3">
                <div class="w-12 h-12 bg-gradient-to-br from-fuchsia-500 to-indigo-600 rounded-2xl flex items-center justify-center text-white text-2xl shadow-md">
                    ğŸ­
                </div>
                <div>
                    <h1 class="text-2xl md:text-3xl font-black text-slate-800 tracking-tight">×¤×•×¨×™××•× ×•×¡×˜×œ×’×™×” ×©×›×‘×•×ª ×–' - ×˜'</h1>
                    <p class="text-sm font-medium text-slate-500">××¢×¨×›×ª ×“×™×’×™×˜×œ×™×ª ×œ× ×™×”×•×œ ×ª×—× ×•×ª - ×—×’ ×¤×•×¨×™× ×©××—!</p>
                </div>
            </div>
            
            <!-- Simulation Control -->
            <div class="flex flex-col items-center bg-slate-100/80 p-3 rounded-2xl border border-slate-200 w-full md:w-auto shadow-inner">
                <div class="flex justify-between items-center w-full mb-2 gap-4">
                    <label for="timeSlider" class="text-xs font-bold text-slate-600 flex items-center gap-2">
                        â±ï¸ ×©×¢×” ×‘××¢×¨×›×ª: 
                        <span id="timeDisplay" class="text-indigo-600 font-black text-lg bg-white px-2 py-0.5 rounded shadow-sm">09:40</span>
                    </label>
                    <button id="liveTimeBtn" class="text-[10px] font-bold px-2 py-1 rounded-md transition-colors bg-slate-200 text-slate-500 cursor-default">
                        ğŸ“… ×××ª×™×Ÿ ×œ-1.3
                    </button>
                </div>
                <input type="range" id="timeSlider" min="580" max="790" value="580" step="1" class="w-full md:w-64 h-2.5 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                <div class="flex justify-between w-full text-[10px] font-bold text-slate-400 mt-1.5 px-1">
                    <span>09:40</span>
                    <span>11:00</span>
                    <span>12:00</span>
                    <span>13:10</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 space-y-10">

        <!-- Intro & Rules Section -->
        <section class="bg-white rounded-3xl shadow-sm border border-slate-200 p-6 md:p-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                <div class="space-y-4">
                    <h2 class="text-2xl font-bold text-slate-800 flex items-center gap-2">
                        <span class="w-2 h-8 bg-orange-400 rounded-full inline-block"></span>
                        ××‘× ×” ×”×¤×¢×™×œ×•×ª - ×”×¤×•×¨×™××•×Ÿ
                    </h2>
                    <p class="text-slate-600 leading-relaxed text-lg">
                        ×”×¤×•×¨×™××•×Ÿ ×©×œ× ×• ×‘× ×•×™ ××ª×—× ×•×ª ×©×¤×•×¢×œ×•×ª ×‘××—×–×•×¨×™×•×ª ××“×•×™×§×ª ×©×œ 10 ×“×§×•×ª.<br>
                        <strong>×©×™××• ×œ×‘:</strong> ×™×©× ×Ÿ 7 ×ª×—× ×•×ª ×¤×¢×™×œ×•×ª, ××š ×‘×›×œ ×¡×‘×‘ ××©×ª×ª×¤×•×ª ×¨×§ 6 ×›×™×ª×•×ª. ×œ×›×Ÿ, ×‘×›×œ ×¨×’×¢ × ×ª×•×Ÿ ×™×© ×ª×—× ×” ××—×ª ×‘×”×¤×¡×§×”.
                    </p>
                    <div class="flex flex-wrap gap-3 mt-2">
                        <span class="px-4 py-1.5 bg-blue-50 text-blue-700 border border-blue-200 text-sm rounded-full font-bold shadow-sm">×¡×‘×‘ ×': ×©×›×‘×” ×˜' (10:00-10:50)</span>
                        <span class="px-4 py-1.5 bg-emerald-50 text-emerald-700 border border-emerald-200 text-sm rounded-full font-bold shadow-sm">×¡×‘×‘ ×‘': ×©×›×‘×” ×–' (11:15-12:00)</span>
                    </div>
                </div>
                
                <div class="bg-slate-50 p-5 sm:p-6 rounded-2xl border border-slate-100">
                    <h3 class="text-center font-bold text-slate-700 mb-4 text-base sm:text-lg">×—×œ×•×§×ª ×”×–××Ÿ ×‘×ª×—× ×” ×‘×¤×•×¨×™××•×Ÿ (10 ×“×§')</h3>
                    <div class="flex h-6 sm:h-8 rounded-full overflow-hidden shadow-inner border border-slate-200 mb-4">
                        <div class="w-1/2 bg-slate-400 transition-colors hover:bg-slate-500" title="5 ×“×§×•×ª: ××¢×‘×¨ ×•×”×ª××¨×’× ×•×ª"></div>
                        <div class="w-1/5 bg-amber-400 transition-colors hover:bg-amber-500" title="2 ×“×§×•×ª: ×§×‘×œ×ª ×”×¡×‘×¨"></div>
                        <div class="w-[30%] bg-blue-500 transition-colors hover:bg-blue-600" title="3 ×“×§×•×ª: ×‘×™×¦×•×¢ ×”×¤×¢×™×œ×•×ª"></div>
                    </div>
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center text-sm font-bold text-slate-700 gap-3 sm:gap-2 bg-white p-4 sm:p-3 rounded-xl shadow-sm border border-slate-100">
                        <div class="flex items-center gap-3">
                            <span class="w-5 h-5 rounded bg-slate-400 shadow-sm flex-shrink-0"></span> 
                            <span>ğŸš¶ ××¢×‘×¨ <span class="text-slate-500 font-medium">(5 ×“×§')</span></span>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="w-5 h-5 rounded bg-amber-400 shadow-sm flex-shrink-0"></span> 
                            <span>ğŸ—£ï¸ ×”×¡×‘×¨ <span class="text-slate-500 font-medium">(2 ×“×§')</span></span>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="w-5 h-5 rounded bg-blue-500 shadow-sm flex-shrink-0"></span> 
                            <span>ğŸ¯ ×¤×¢×™×œ×•×ª <span class="text-slate-500 font-medium">(3 ×“×§')</span></span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Schedule Section -->
        <section id="interactive-schedule" class="bg-white rounded-3xl shadow-lg border border-slate-200 overflow-hidden">
            
            <div class="p-6 md:p-8">
                
                <!-- Modern Tabs Navigation -->
                <div class="flex flex-wrap sm:flex-nowrap p-1.5 bg-slate-100 rounded-2xl mb-8 border border-slate-200 gap-1">
                    <button onclick="switchTab('general')" id="tab-general" class="flex-1 min-w-[100px] py-3 px-2 rounded-xl text-center font-bold text-sm md:text-base transition-all duration-200 tab-active text-teal-600">
                        ğŸ“… ×œ×•"×– ×›×œ×œ×™
                    </button>
                    <button onclick="switchTab('participant')" id="tab-participant" class="flex-1 min-w-[100px] py-3 px-2 rounded-xl text-center font-bold text-sm md:text-base transition-all duration-200 tab-inactive">
                        ğŸ‘¨â€ğŸ“ ××¡×œ×•×œ ××™×©×™
                    </button>
                    <button onclick="switchTab('operator')" id="tab-operator" class="flex-1 min-w-[100px] py-3 px-2 rounded-xl text-center font-bold text-sm md:text-base transition-all duration-200 tab-inactive">
                        ğŸ› ï¸ ××¤×¢×™×œ×™×
                    </button>
                    <button onclick="switchTab('master')" id="tab-master" class="flex-1 min-w-[100px] py-3 px-2 rounded-xl text-center font-bold text-sm md:text-base transition-all duration-200 tab-inactive">
                        ğŸ“Š ×× ×”×œ×™×
                    </button>
                </div>

                <!-- View 0: General Schedule View -->
                <div id="view-general" class="space-y-6 animation-fade-in">
                    <div class="bg-teal-50 border border-teal-100 rounded-2xl p-5 mb-8">
                        <h3 class="font-bold text-teal-900 text-lg">×œ×•"×– ×¤×•×¨×™××•× ×•×¡×˜×œ×’×™×” ×œ×©×›×‘×•×ª ×–', ×˜'</h3>
                        <p class="text-sm text-teal-700 mt-1">××‘×˜ ×¢×œ ×œ×›×œ ×”×¤×¢×™×œ×•×™×•×ª ×œ××•×¨×š ×”×™×•×. ×”×©×•×¨×” ×”××•×“×’×©×ª ××¨××” ××” ××ª×¨×—×© ×¢×›×©×™×•!</p>
                    </div>
                    
                    <div class="overflow-x-auto pb-4">
                        <table class="w-full text-right border-collapse rounded-xl overflow-hidden shadow-sm">
                            <thead class="text-sm text-slate-700 bg-slate-200 font-bold border-b-2 border-slate-300">
                                <tr>
                                    <th class="px-5 py-4 w-24">×©×¢×”</th>
                                    <th class="px-5 py-4 border-r border-slate-300 w-1/3">×©×›×‘×ª ×–'</th>
                                    <th class="px-5 py-4 border-r border-slate-300 w-1/3">×©×›×‘×ª ×˜'</th>
                                    <th class="px-5 py-4 border-r border-slate-300">×”×¢×¨×•×ª</th>
                                </tr>
                            </thead>
                            <tbody id="generalTableBody" class="divide-y divide-slate-200 bg-white text-base">
                                <!-- Data rendered by JS for dynamic highlighting -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- View 1: Participant View -->
                <div id="view-participant" class="hidden space-y-6 animation-fade-in">
                    <div class="flex flex-col md:flex-row gap-4 items-center justify-between bg-blue-50 border border-blue-100 rounded-2xl p-5 mb-8">
                        <div class="text-center md:text-right w-full md:w-auto">
                            <h3 class="font-bold text-blue-900 text-lg">×”×œ×•"×– ×”××™×©×™ ×”×¨×¦×™×£ ×©×œ×š</h3>
                            <p class="text-sm text-blue-700 mt-1">×‘×—×¨×• ××ª ×”×›×™×ª×” ×©×œ×›× ×•×”××¢×¨×›×ª ×ª×¦×™×’ ××ª ×¦×™×¨ ×”×–××Ÿ ×”××œ× (×›×•×œ×œ ×ª×—× ×•×ª ×”×¤×•×¨×™××•×Ÿ ×‘×“×§×•×ª ×”××“×•×™×§×•×ª) ×•××¤×ª ×”×ª××¦××•×ª.</p>
                        </div>
                        <div class="flex items-center gap-3 w-full md:w-auto">
                            <select id="classSelector" class="px-5 py-3 border-2 border-blue-200 rounded-xl bg-white shadow-sm focus:border-blue-500 focus:ring-0 outline-none w-full md:w-48 font-bold text-slate-700 cursor-pointer hover:bg-blue-50/50 transition-colors">
                                <option value="" disabled selected>×‘×—×¨×• ×›×™×ª×”...</option>
                                <optgroup label="×©×›×‘×” ×˜'">
                                    <option value="×˜1">×˜1 ×’×™×¨</option>
                                    <option value="×˜2">×˜2 ×œ×‘×”</option>
                                    <option value="×˜3">×˜3 ×¡×”×¨×”</option>
                                    <option value="×˜4">×˜4 ×¡×œ×¢</option>
                                    <option value="×˜5">×˜5 ×’×‘×¢</option>
                                    <option value="×˜6">×˜6 ×××’××”</option>
                                </optgroup>
                                <optgroup label="×©×›×‘×” ×–'">
                                    <option value="×–1">×–1 ×©×“×”</option>
                                    <option value="×–2">×–2 ×›×¨×</option>
                                    <option value="×–3">×–3 ××œ×•××”</option>
                                    <option value="×–4">×–4 ×¤×¨×“×¡</option>
                                    <option value="×–5">×–5 ×ª×œ×ª×Ÿ</option>
                                    <option value="×–6">×–6 ××©×›×•×œ</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>

                    <div id="participantResult" class="hidden">
                        <!-- Content injected by JS -->
                    </div>
                </div>

                <!-- View 2: Operator View -->
                <div id="view-operator" class="hidden space-y-6">
                    <div class="flex flex-col md:flex-row gap-4 items-center justify-between bg-orange-50 border border-orange-100 rounded-2xl p-5 mb-8">
                        <div class="text-center md:text-right w-full md:w-auto">
                            <h3 class="font-bold text-orange-900 text-lg">× ×™×”×•×œ ×ª×—× ×” - ×©×›×‘×ª ×—' (×¤×•×¨×™××•×Ÿ)</h3>
                            <p class="text-sm text-orange-700 mt-1">×‘×—×¨×• ××ª ×”×ª×—× ×” ×©××ª× ××¤×¢×™×œ×™×. ×‘××¤×©×¨×•×ª×›× ×œ×”×¤×¢×™×œ ×”×ª×¨××•×ª ×§×•×œ×™×•×ª ×œ×§×¨××ª ×¡×™×•× ×”×–××Ÿ.</p>
                            <label class="inline-flex items-center mt-3 cursor-pointer">
                                <input type="checkbox" id="audioToggle" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-500"></div>
                                <span class="ms-3 text-sm font-bold text-orange-800">×”×¤×¢×œ ×¦×¤×¦×•×£ ××¢×‘×¨ ×ª×—× ×” (×›×œ 10 ×“×§')</span>
                            </label>
                        </div>
                        <div class="flex flex-col gap-2 w-full md:w-auto">
                            <select id="stationSelector" class="px-5 py-3 border-2 border-orange-200 rounded-xl bg-white shadow-sm focus:border-orange-500 focus:ring-0 outline-none w-full md:w-56 font-bold text-slate-700 cursor-pointer hover:bg-orange-50/50 transition-colors">
                                <option value="" disabled selected>×‘×—×¨×• ×ª×—× ×”...</option>
                                <option value="1">×ª×—× ×” 1 - ×—1 ×¤×™×¡×˜×•×§ (×™×‘×™×œ×”)</option>
                                <option value="2">×ª×—× ×” 2 - ×—2 ×¤×§××Ÿ (×œ××¢×œ×” ×™××™×Ÿ)</option>
                                <option value="3">×ª×—× ×” 3 - ×—3 ×—×•××•×¡ (×œ××¢×œ×” ×©×××œ)</option>
                                <option value="4">×ª×—× ×” 4 - ×—4 ×‘×•×˜×Ÿ (×œ××˜×” ×™××™×Ÿ)</option>
                                <option value="5">×ª×—× ×” 5 - ×—5 ×§×©×™×• (×œ××¢×œ×” ×××¦×¢)</option>
                                <option value="6">×ª×—× ×” 6 - ×—6 ×©×§×“ (×œ××˜×” ×××¦×¢)</option>
                                <option value="7">×ª×—× ×” 7 - ×—7 ××’×•×– ×œ×•×– (×œ××˜×” ×©×××œ)</option>
                            </select>
                        </div>
                    </div>

                    <div id="operatorResult" class="hidden">
                         <!-- Content injected by JS -->
                    </div>
                </div>

                <!-- View 3: Master View -->
                <div id="view-master" class="hidden">
                     <div class="bg-indigo-50 border border-indigo-100 rounded-2xl p-5 mb-8">
                        <h3 class="font-bold text-indigo-900 text-lg">×œ×•×— ×‘×§×¨×” ×œ×¤×•×¨×™××•×Ÿ (×ª×—× ×•×ª)</h3>
                        <p class="text-sm text-indigo-700 mt-1">×˜×‘×œ×” ××¨×›×–×ª ×©×œ ×›×œ ×ª× ×•×¢×•×ª ×”×›×™×ª×•×ª ×‘×™×Ÿ ×”×ª×—× ×•×ª.</p>
                    </div>
                    
                    <div class="overflow-x-auto pb-4">
                        <h4 class="text-xl font-black mb-4 text-slate-800 flex items-center gap-2">
                            <span class="w-3 h-3 rounded-full bg-blue-500"></span>
                            ×¡×‘×‘ ×' - ×©×›×‘×” ×˜'
                        </h4>
                        <table class="w-full text-sm text-right text-slate-600 mb-10 border-collapse rounded-xl overflow-hidden shadow-sm">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-200">
                                <tr>
                                    <th class="px-4 py-4 min-w-[100px]">×©×¢×”</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×˜1 ×’×™×¨</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×˜2 ×œ×‘×”</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×˜3 ×¡×”×¨×”</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×˜4 ×¡×œ×¢</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×˜5 ×’×‘×¢</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×˜6 ×××’××”</th>
                                    <th class="px-4 py-4 bg-orange-200 text-orange-900 font-black whitespace-nowrap">â¸ï¸ ×‘×”×¤×¡×§×”</th>
                                </tr>
                            </thead>
                            <tbody id="masterTableBodyA" class="divide-y divide-slate-200 bg-white">
                                <!-- JS Generated -->
                            </tbody>
                        </table>

                        <h4 class="text-xl font-black mb-4 text-slate-800 flex items-center gap-2">
                            <span class="w-3 h-3 rounded-full bg-emerald-500"></span>
                            ×¡×‘×‘ ×‘' - ×©×›×‘×” ×–'
                        </h4>
                        <table class="w-full text-sm text-right text-slate-600 border-collapse rounded-xl overflow-hidden shadow-sm">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-200">
                                <tr>
                                    <th class="px-4 py-4 min-w-[100px]">×©×¢×”</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×–1 ×©×“×”</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×–2 ×›×¨×</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×–3 ××œ×•××”</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×–4 ×¤×¨×“×¡</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×–5 ×ª×œ×ª×Ÿ</th>
                                    <th class="px-4 py-4 whitespace-nowrap">×–6 ××©×›×•×œ</th>
                                    <th class="px-4 py-4 bg-orange-200 text-orange-900 font-black whitespace-nowrap">â¸ï¸ ×‘×”×¤×¡×§×”</th>
                                </tr>
                            </thead>
                            <tbody id="masterTableBodyB" class="divide-y divide-slate-200 bg-white">
                                <!-- JS Generated -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Live Status Footer -->
        <section class="bg-gradient-to-r from-slate-900 to-slate-800 text-white rounded-3xl p-6 md:p-8 shadow-2xl relative overflow-hidden">
             <div class="absolute -right-10 -top-10 w-40 h-40 bg-white opacity-5 rounded-full blur-2xl"></div>
             
             <div class="flex flex-col md:flex-row items-center justify-between relative z-10">
                 <div class="text-center md:text-right mb-4 md:mb-0">
                     <h3 class="text-xl font-bold text-white mb-1">×¡×˜×˜×•×¡ ×¤×¢×™×œ×•×ª ×‘×–××Ÿ ×××ª</h3>
                     <p class="text-slate-400 font-medium" id="liveStatusText">×××ª×™×Ÿ ×œ× ×ª×•× ×™×...</p>
                 </div>
                 
                 <!-- Countdown Timer Section -->
                 <div class="flex items-center gap-4">
                     <div class="text-center" id="countdownContainer">
                         <div class="text-xs text-slate-400 mb-1 font-bold">×–××Ÿ × ×•×ª×¨ ×œ×¤×¢×™×œ×•×ª:</div>
                         <div class="px-4 py-2 bg-slate-800 rounded-xl border border-slate-600 shadow-inner flex items-baseline justify-center gap-1 min-w-[90px]">
                             <span id="timerMinutes" class="font-mono text-2xl font-black text-white">00</span>
                             <span class="text-slate-400 font-bold">:</span>
                             <span id="timerSeconds" class="font-mono text-xl font-bold text-slate-300">00</span>
                         </div>
                     </div>
                     <div class="px-6 py-4 bg-black/30 backdrop-blur-sm rounded-2xl border border-white/10 shadow-inner h-full flex items-center">
                         <span id="currentActivityLabel" class="font-mono text-2xl tracking-wider text-amber-400 font-bold">00:00</span>
                     </div>
                 </div>
             </div>
        </section>

    </main>

    <footer class="bg-transparent py-6 text-center text-sm text-slate-500 font-medium mt-auto">
        <div class="container mx-auto">
            <p>Â© 2026 ×¤×•×¨×™××•× ×•×¡×˜×œ×’×™×” ×‘×™×ª ×¡×¤×¨×™×ª. ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª.</p>
        </div>
    </footer>

    <script>
        // --- Data Definitions ---
        
        const generalDaySchedule = [
            { start: 580, end: 600, label: "09:40", zGrade: "×‘×•×§×¨ ×˜×•×‘ ×‘×›×™×ª×•×ª", tGrade: "×‘×•×§×¨ ×˜×•×‘ ×‘×›×™×ª×•×ª", notes: "×¨×™×©×•× × ×•×›×—×•×ª", merged: true },
            { start: 600, end: 650, label: "10:00", zGrade: "××¡×™×‘×ª ××•×–× ×™×•×ª", tGrade: "×¤×•×¨×™××•×Ÿ", notes: "×ª×—×™×œ×ª ×¡×‘×‘ ×'", isPurimon: true },
            { start: 650, end: 675, label: "10:50", zGrade: "×“×•×›× ×™ ××•×›×œ", tGrade: "×“×•×›× ×™ ××•×›×œ", notes: "×—' ×’× ×‘×”×¤×¡×§×”<br>(×—×•×¥ ×××¤×¢×™×œ×™ ×“×•×›× ×™ ×”××•×›×œ)", merged: true },
            { start: 675, end: 720, label: "11:15", zGrade: "×¤×•×¨×™××•×Ÿ", tGrade: "××¡×™×‘×ª ××•×–× ×™×•×ª", notes: "×ª×—×™×œ×ª ×¡×‘×‘ ×‘' (×”×—×œ×¤×”)", isPurimon: true },
            { start: 720, end: 745, label: "12:00", zGrade: "× ×™×§×™×•× ×•×ª ×›×™×ª×” + ×ª××•× ×” ×›×™×ª×ª×™×ª", tGrade: "× ×™×§×™×•× ×•×ª ×›×™×ª×” + ×ª××•× ×” ×›×™×ª×ª×™×ª", notes: "×—' ×’× ×‘× ×™×§×™×•× ×•×ª", merged: true },
            { start: 745, end: 780, label: "12:25", zGrade: "×›×™× ×•×¡ ×•×ª×—×¨×•×ª ×ª×—×¤×•×©×•×ª", tGrade: "×›×™× ×•×¡ ×•×ª×—×¨×•×ª ×ª×—×¤×•×©×•×ª", notes: "×›×œ×œ ×—×˜×™×‘×ª×™<br>(×§×™×¤×•×œ ×œ×“×•×›× ×™ ××•×›×œ)", merged: true },
            { start: 780, end: 795, label: "13:00", zGrade: "×™×¦×™××” ×œ×”×¡×¢×•×ª", tGrade: "×™×¦×™××” ×œ×”×¡×¢×•×ª", notes: "×”×¡×¢×•×ª ×‘-13:10", merged: true }
        ];

        const scheduleData = {
            roundA: {
                name: "×¡×‘×‘ ×' (×©×›×‘×” ×˜')",
                times: ["10:00", "10:10", "10:20", "10:30", "10:40"],
                startMin: 600,
                matrix: [
                    [1, 2, 3, 4, 5, 6, 7], 
                    [2, 3, 4, 5, 6, 7, 1], 
                    [3, 4, 5, 6, 7, 1, 2], 
                    [4, 5, 6, 7, 1, 2, 3], 
                    [5, 6, 7, 1, 2, 3, 4]  
                ]
            },
            roundB: {
                name: "×¡×‘×‘ ×‘' (×©×›×‘×” ×–')",
                times: ["11:15", "11:25", "11:35", "11:45"],
                startMin: 675,
                matrix: [
                    [1, 2, 3, 4, 5, 6, 7], 
                    [2, 3, 4, 5, 6, 7, 1], 
                    [3, 4, 5, 6, 7, 1, 2], 
                    [4, 5, 6, 7, 1, 2, 3]  
                ]
            }
        };

        const classNames = {
            "×˜1": "×˜1 ×’×™×¨", "×˜2": "×˜2 ×œ×‘×”", "×˜3": "×˜3 ×¡×”×¨×”", "×˜4": "×˜4 ×¡×œ×¢", "×˜5": "×˜5 ×’×‘×¢", "×˜6": "×˜6 ×××’××”",
            "×–1": "×–1 ×©×“×”", "×–2": "×–2 ×›×¨×", "×–3": "×–3 ××œ×•××”", "×–4": "×–4 ×¤×¨×“×¡", "×–5": "×–5 ×ª×œ×ª×Ÿ", "×–6": "×–6 ××©×›×•×œ"
        };

        const stationDetails = {
            1: { name: "×—1 ×¤×™×¡×˜×•×§", location: "×›×™×ª×” ×™×‘×™×œ×”" },
            2: { name: "×—2 ×¤×§××Ÿ", location: "×œ××¢×œ×” ×™××™×Ÿ" },
            3: { name: "×—3 ×—×•××•×¡", location: "×œ××¢×œ×” ×©×××œ" },
            4: { name: "×—4 ×‘×•×˜×Ÿ", location: "×œ××˜×” ×™××™×Ÿ" },
            5: { name: "×—5 ×§×©×™×•", location: "×œ××¢×œ×” ×××¦×¢" },
            6: { name: "×—6 ×©×§×“", location: "×œ××˜×” ×××¦×¢" },
            7: { name: "×—7 ××’×•×– ×œ×•×–", location: "×œ××˜×” ×©×××œ" }
        };

        // --- State Management ---
        let currentTab = 'general';
        let simulatedTime = 580; // minutes from midnight
        let currentSeconds = 0; // seconds 0-59
        let isLiveMode = true; 
        const EVENT_DATE_STR = '2026-03-01';
        let lastMinuteRendered = -1; // To prevent heavy DOM re-renders every second
        let audioEnabled = false;

        // Elements
        const classSelector = document.getElementById('classSelector');
        const stationSelector = document.getElementById('stationSelector');
        const timeSlider = document.getElementById('timeSlider');
        const timeDisplay = document.getElementById('timeDisplay');
        const liveStatusText = document.getElementById('liveStatusText');
        const currentActivityLabel = document.getElementById('currentActivityLabel');
        const liveTimeBtn = document.getElementById('liveTimeBtn');
        const timerMinutesEl = document.getElementById('timerMinutes');
        const timerSecondsEl = document.getElementById('timerSeconds');
        const audioToggle = document.getElementById('audioToggle');

        // --- Sound Generator ---
        const playBeep = () => {
            if (!audioEnabled) return;
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.type = 'sine';
                osc.frequency.setValueAtTime(880, ctx.currentTime); // A5 note
                gain.gain.setValueAtTime(0.5, ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.8);
                osc.start(ctx.currentTime);
                osc.stop(ctx.currentTime + 0.8);
            } catch (e) { console.error("Audio block", e); }
        };

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderMasterTable();
            renderGeneralTable();
            
            // Tab Switching
            window.switchTab = (tab) => {
                document.querySelectorAll('button[id^="tab-"]').forEach(btn => {
                    btn.classList.remove('tab-active', 'text-blue-600', 'text-orange-600', 'text-indigo-600', 'text-teal-600');
                    btn.classList.add('tab-inactive');
                });
                
                const activeBtn = document.getElementById(`tab-${tab}`);
                activeBtn.classList.remove('tab-inactive');
                activeBtn.classList.add('tab-active');
                
                if(tab === 'general') activeBtn.classList.add('text-teal-600');
                if(tab === 'participant') activeBtn.classList.add('text-blue-600');
                if(tab === 'operator') activeBtn.classList.add('text-orange-600');
                if(tab === 'master') activeBtn.classList.add('text-indigo-600');

                ['general', 'participant', 'operator', 'master'].forEach(t => {
                    document.getElementById(`view-${t}`).classList.add('hidden');
                });
                document.getElementById(`view-${tab}`).classList.remove('hidden');
                
                currentTab = tab;
                forceFullRender();
            };

            switchTab('general');

            // Listeners
            classSelector.addEventListener('change', (e) => renderParticipantView(e.target.value));
            stationSelector.addEventListener('change', (e) => renderOperatorView(e.target.value));
            audioToggle.addEventListener('change', (e) => { audioEnabled = e.target.checked; });

            // Slider Override
            timeSlider.addEventListener('input', (e) => {
                isLiveMode = false;
                liveTimeBtn.innerHTML = 'â–¶ï¸ ×—×–×•×¨ ×œ×–××Ÿ ×××ª';
                liveTimeBtn.className = 'text-[10px] font-bold px-2 py-1 rounded-md transition-colors bg-amber-100 text-amber-700 border border-amber-200 cursor-pointer shadow-sm hover:bg-amber-200';
                
                simulatedTime = parseInt(e.target.value);
                currentSeconds = 0; // reset seconds on manual drag
                updateSystemLogic(true);
            });
            
            // Revert to Live
            liveTimeBtn.addEventListener('click', () => {
                if(!isLiveMode) {
                    isLiveMode = true;
                    lastMinuteRendered = -1; // force render
                    tickClock();
                }
            });
            
            initClock();
        });

        // --- Clock & Main Logic Loop ---
        function initClock() {
            tickClock();
            setInterval(tickClock, 1000); // Check every 1 second!
        }

        function tickClock() {
            if (!isLiveMode) return;

            const now = new Date();
            const currentDateStr = now.getFullYear() + '-' + String(now.getMonth() + 1).padStart(2, '0') + '-' + String(now.getDate()).padStart(2, '0');
            
            if (currentDateStr === EVENT_DATE_STR) {
                liveTimeBtn.innerHTML = 'ğŸ”´ ××—×•×‘×¨ ×œ×–××Ÿ ×××ª';
                liveTimeBtn.className = 'text-[10px] font-bold px-2 py-1 rounded-md transition-colors bg-indigo-100 text-indigo-700 border border-indigo-200 shadow-sm cursor-default';
                
                const currentMins = now.getHours() * 60 + now.getMinutes();
                simulatedTime = currentMins;
                currentSeconds = now.getSeconds();
                
                // Update slider visually without triggering input event
                const sliderVal = Math.max(580, Math.min(790, simulatedTime));
                timeSlider.value = sliderVal;
            } else {
                liveTimeBtn.innerHTML = 'ğŸ“… ×™×•×¤×¢×œ ×‘-1.3';
                liveTimeBtn.className = 'text-[10px] font-bold px-2 py-1 rounded-md transition-colors bg-slate-200 text-slate-500 cursor-default';
                // If not event date, run time artificially for demo purposes if left untouched, or stick to slider
                simulatedTime = parseInt(timeSlider.value); 
                currentSeconds = 0;
            }
            
            updateSystemLogic(false);
        }

        function updateSystemLogic(force = false) {
            // Check if we crossed a minute boundary
            const minuteChanged = (simulatedTime !== lastMinuteRendered);
            
            // 1. Update text that changes every second (Timers)
            updateLiveStatusAndTimer();
            
            // 2. Play Audio Alert if crossing a 10-min slot during Purimon (00 sec)
            if (isLiveMode && currentSeconds === 0 && minuteChanged) {
                if ((simulatedTime > 600 && simulatedTime <= 650) || (simulatedTime > 675 && simulatedTime <= 715)) {
                    if (simulatedTime % 10 === 0 || simulatedTime % 10 === 5) { // e.g. 10:10, 11:25
                        playBeep();
                    }
                }
            }

            // 3. Only re-render heavy DOM elements if the minute changed or forced
            if (minuteChanged || force) {
                const hours = Math.floor(simulatedTime / 60);
                const minutes = simulatedTime % 60;
                timeDisplay.textContent = `${hours}:${minutes < 10 ? '0'+minutes : minutes}`;
                
                renderGeneralTable(); 
                
                if (currentTab === 'participant' && classSelector.value) renderParticipantView(classSelector.value);
                if (currentTab === 'operator' && stationSelector.value) renderOperatorView(stationSelector.value);
                
                lastMinuteRendered = simulatedTime;
            }
        }

        function forceFullRender() {
            updateSystemLogic(true);
        }

        // --- Map Component HTML Generator ---
        function getMapHtml(activeStationNum = null) {
            const getLocClass = (stationId) => {
                return (activeStationNum === stationId) ? "map-cell active-loc" : "map-cell";
            };

            return `
            <div class="map-container bg-white p-5 rounded-2xl border border-slate-200 shadow-sm mt-6">
                <h5 class="font-bold text-slate-700 mb-4 text-center">ğŸ—ºï¸ ××¤×ª ×”×ª××¦××•×ª ×‘××ª×—×</h5>
                <div class="map-grid">
                    <div class="${getLocClass(3)}">×œ××¢×œ×” ×©×××œ<br><span class="text-xs font-normal opacity-80">(×—3)</span></div>
                    <div class="${getLocClass(5)}">×œ××¢×œ×” ×××¦×¢<br><span class="text-xs font-normal opacity-80">(×—5)</span></div>
                    <div class="${getLocClass(2)}">×œ××¢×œ×” ×™××™×Ÿ<br><span class="text-xs font-normal opacity-80">(×—2)</span></div>
                    <div class="${getLocClass(7)}">×œ××˜×” ×©×××œ<br><span class="text-xs font-normal opacity-80">(×—7)</span></div>
                    <div class="${getLocClass(6)}">×œ××˜×” ×××¦×¢<br><span class="text-xs font-normal opacity-80">(×—6)</span></div>
                    <div class="${getLocClass(4)}">×œ××˜×” ×™××™×Ÿ<br><span class="text-xs font-normal opacity-80">(×—4)</span></div>
                </div>
                <div class="mt-3 text-center">
                    <div class="${getLocClass(1)} inline-block px-8">×›×™×ª×” ×™×‘×™×œ×” <span class="font-normal opacity-80">(×—1)</span></div>
                </div>
            </div>`;
        }

        // --- View Renderers ---

        function renderGeneralTable() {
            const tbody = document.getElementById('generalTableBody');
            tbody.innerHTML = '';
            
            generalDaySchedule.forEach(slot => {
                const isActive = simulatedTime >= slot.start && simulatedTime < slot.end;
                const trClass = isActive ? "bg-teal-100/60 ring-inset ring-2 ring-teal-400 font-bold transition-all shadow-md transform scale-[1.01]" : "transition-colors hover:bg-slate-50";
                const timeColor = isActive ? "text-teal-800" : "text-slate-800";
                
                let rowHtml = `<tr class="${trClass}">
                                <td class="px-5 py-5 font-mono ${timeColor} font-bold align-middle">${slot.label}</td>`;
                
                if (slot.merged) {
                    rowHtml += `<td class="px-5 py-5 text-center text-slate-700 border-r border-slate-300 align-middle" colspan="2">${slot.zGrade}</td>`;
                } else {
                    const zClass = slot.zGrade.includes('××•×–× ×™×•×ª') ? 'text-indigo-700' : 'text-blue-700';
                    const tClass = slot.tGrade.includes('××•×–× ×™×•×ª') ? 'text-indigo-700' : 'text-blue-700';
                    rowHtml += `<td class="px-5 py-5 text-center ${zClass} border-r border-slate-300 align-middle">${slot.zGrade}</td>
                                <td class="px-5 py-5 text-center ${tClass} border-r border-slate-300 align-middle">${slot.tGrade}</td>`;
                }
                
                rowHtml += `<td class="px-5 py-5 text-slate-500 text-sm border-r border-slate-300 align-middle leading-tight">${slot.notes}</td></tr>`;
                tbody.innerHTML += rowHtml;
            });
        }

        function renderParticipantView(classId) {
            const container = document.getElementById('participantResult');
            container.innerHTML = '';
            container.classList.remove('hidden');

            const isGrade9 = classId.startsWith('×˜');
            const flatSchedule = [];
            let currentStationNum = null;
            
            // Build timeline array
            generalDaySchedule.forEach(slot => {
                const myActivity = isGrade9 ? slot.tGrade : slot.zGrade;
                
                if (slot.isPurimon && myActivity.includes('×¤×•×¨×™××•×Ÿ')) {
                    const roundKey = isGrade9 ? 'roundA' : 'roundB';
                    const data = scheduleData[roundKey];
                    const classIndex = parseInt(classId.substring(1)) - 1;
                    
                    data.times.forEach((timeStr, idx) => {
                        if (data.matrix[idx]) {
                            const station = data.matrix[idx][classIndex];
                            if (station) {
                                const startMins = timeToMins(timeStr);
                                const stInfo = stationDetails[station];
                                
                                if (simulatedTime >= startMins && simulatedTime < startMins + 10) {
                                    currentStationNum = station; // Catch active station for map
                                }

                                flatSchedule.push({
                                    start: startMins,
                                    end: startMins + 10,
                                    label: timeStr,
                                    title: `×ª×—× ×” ${station}: <span class="text-indigo-600">${stInfo.location}</span>`,
                                    notes: `××¤×¢×™×œ×™×: ${stInfo.name}`,
                                    icon: 'ğŸ¯',
                                    isStation: true
                                });
                            }
                        }
                    });
                    
                    if (!isGrade9) {
                        flatSchedule.push({
                            start: 715, end: 720, label: "11:55", title: "×¡×™×•× ×”×¤×•×¨×™××•×Ÿ", notes: "×—×–×¨×” ×œ×›×™× ×•×¡ (×›×œ ×”×›×™×ª×•×ª)", icon: 'ğŸš¶', isStation: false
                        });
                    }
                } else {
                    let icon = 'ğŸ“Œ';
                    if(myActivity.includes('×‘×•×§×¨')) icon = 'â˜€ï¸';
                    if(myActivity.includes('××•×–× ×™×•×ª')) icon = 'ğŸ§';
                    if(myActivity.includes('××•×›×œ')) icon = 'ğŸ”';
                    if(myActivity.includes('× ×™×§×™×•×Ÿ')) icon = 'ğŸ§¹';
                    if(myActivity.includes('×ª×—×¤×•×©×•×ª')) icon = 'ğŸ¦¸â€â™‚ï¸';
                    if(myActivity.includes('×”×¡×¢×•×ª')) icon = 'ğŸšŒ';
                    
                    flatSchedule.push({
                        start: slot.start, end: slot.end, label: slot.label, title: myActivity, notes: slot.notes, icon: icon, isStation: false
                    });
                }
            });

            // Banner Check
            let currentAlertHtml = "";
            let foundCurrent = false;
            
            flatSchedule.forEach(item => {
                if (simulatedTime >= item.start && simulatedTime < item.end) {
                    const hours = Math.floor(simulatedTime / 60);
                    const minutes = (simulatedTime % 60).toString().padStart(2, '0');
                    currentAlertHtml = `
                    <div class="bg-indigo-600 text-white rounded-2xl p-5 mb-8 shadow-xl text-center animate-pulse-slow border-4 border-indigo-400 relative overflow-hidden">
                        <div class="absolute -right-4 -top-4 text-7xl opacity-20">${item.icon}</div>
                        <span class="block text-sm md:text-base font-medium mb-1 opacity-90 relative z-10">×”×©×¢×” ×¢×›×©×™×• ${hours}:${minutes}. ×œ×¤×™ ×”×œ×•"×– ××ª× ×¦×¨×™×›×™× ×œ×”×™×•×ª ×‘:</span>
                        <span class="text-3xl md:text-4xl font-black block mt-2 relative z-10">${item.title}</span>
                    </div>`;
                    foundCurrent = true;
                }
            });

            // Generate HTML
            let html = `<div class="flex flex-col xl:flex-row gap-8">`; // Layout split for Map
            html += `<div class="flex-grow">`; // Left Col (Timeline)
            html += `<h4 class="text-2xl font-black mb-8 text-slate-800">×”××¡×œ×•×œ ×©×œ: ${classNames[classId]}</h4>`;
            
            if (foundCurrent) html += currentAlertHtml;

            html += `<div class="relative vertical-timeline w-full pl-0 md:pl-8 pr-12 md:pr-16 space-y-6">`;
            
            flatSchedule.forEach(item => {
                const isActiveSlot = simulatedTime >= item.start && simulatedTime < item.end;
                const endTimeStr = `${Math.floor(item.end / 60)}:${(item.end % 60).toString().padStart(2, '0')}`;
                
                const ringClass = isActiveSlot 
                    ? 'ring-4 ring-blue-200 border-blue-500 bg-blue-50 transform scale-[1.02] shadow-lg z-10' 
                    : (item.isStation ? 'border-slate-200 bg-white/80' : 'border-slate-200 bg-white');
                    
                const pulseDot = isActiveSlot 
                    ? '<div class="absolute -right-[2.6rem] md:-right-[3.1rem] top-6 w-5 h-5 bg-blue-500 rounded-full border-4 border-white shadow animate-pulse z-10"></div>' 
                    : '<div class="absolute -right-[2.4rem] md:-right-[2.9rem] top-6 w-3 h-3 bg-slate-300 rounded-full border-2 border-white z-10"></div>';

                const borderLeftClass = item.isStation ? 'border-r-4 border-r-indigo-400' : '';

                html += `
                <div class="relative w-full rounded-2xl border-2 p-5 md:p-6 shadow-sm transition-all ${ringClass} ${borderLeftClass}">
                    ${pulseDot}
                    <div class="flex flex-col md:flex-row justify-between md:items-center mb-3">
                        <span class="font-mono font-bold text-slate-500 bg-slate-100 px-3 py-1 rounded w-fit mb-2 md:mb-0">${item.label} - ${endTimeStr}</span>
                        ${isActiveSlot ? '<span class="text-xs bg-blue-600 text-white px-2 py-1 rounded font-bold animate-pulse absolute top-4 left-4 md:static">××ª× ×›××Ÿ ×¢×›×©×™×•!</span>' : ''}
                    </div>
                    <div class="text-xl md:text-2xl font-black text-slate-800 flex items-center gap-3">
                        <span>${item.icon}</span> <span>${item.title}</span>
                    </div>
                    <div class="text-slate-500 text-sm mt-2 font-medium">${item.notes}</div>
                </div>`;
            });

            html += `</div></div>`; // Close Timeline Col
            
            // Right Col (Map - Sticky on desktop)
            html += `<div class="w-full xl:w-1/3 flex-shrink-0">
                        <div class="sticky top-24">
                            ${getMapHtml(currentStationNum)}
                        </div>
                     </div>`;
            
            html += `</div>`; // Close Layout split
            container.innerHTML = html;
        }

        function renderOperatorView(stationStr) {
            const container = document.getElementById('operatorResult');
            container.innerHTML = '';
            container.classList.remove('hidden');
            
            const stationNum = parseInt(stationStr);
            const stInfo = stationDetails[stationNum];
            
            // Layout split for Map
            let html = `<div class="flex flex-col xl:flex-row gap-8">`;
            html += `<div class="flex-grow">`; 
            
            html += `<h4 class="text-2xl font-black mb-6 text-slate-800">×œ×•"×– ×”×¤×¢×œ×”: ×ª×—× ×” ${stationNum} <span class="text-lg font-medium text-slate-500 block mt-1">(${stInfo.name} | ××™×§×•×: ${stInfo.location})</span></h4>`;
            html += `<div class="grid grid-cols-1 gap-8">`;

            // Round A
            html += `<div class="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">`;
            html += `<div class="bg-blue-50 px-6 py-4 font-black text-blue-900 border-b border-blue-100 flex items-center justify-between">
                        <span>×¡×‘×‘ ×' (×©×›×‘×” ×˜')</span>
                        <span class="text-xs bg-white text-blue-700 px-2 py-1 rounded-md shadow-sm">10:00 - 10:50</span>
                     </div>`;
            html += `<div class="divide-y divide-slate-100">`;
            
            scheduleData.roundA.times.forEach((time, idx) => {
                const row = scheduleData.roundA.matrix[idx];
                const classIdx = row.indexOf(stationNum);
                
                let visitorClass = "";
                let isRest = false;
                
                const slotStart = timeToMins(time);
                const isActive = simulatedTime >= slotStart && simulatedTime < (slotStart + 10);
                
                if (classIdx !== -1 && classIdx < 6) {
                    visitorClass = `×××¨×—×™× ××ª ${classNames['×˜' + (classIdx + 1)]}`;
                } else if (row[6] === stationNum) {
                    visitorClass = "â¸ï¸ ×–××Ÿ ×”×¤×¡×§×” ×•×× ×•×—×”";
                    isRest = true;
                }

                html += `
                <div class="flex items-center p-4 transition-colors 
                    ${isActive ? 'bg-indigo-100 border-r-4 border-indigo-500 shadow-inner' : ''}
                    ${!isActive && isRest ? 'bg-orange-50/50 hover:bg-orange-50' : ''}
                    ${!isActive && !isRest ? 'hover:bg-slate-50' : ''}
                ">
                    <div class="w-24 font-mono font-bold text-sm ${isActive ? 'text-indigo-700 bg-white shadow-sm' : 'text-slate-500 bg-slate-100'} px-2 py-1 rounded text-center">${time}</div>
                    <div class="flex-grow font-bold px-4 
                        ${isActive ? 'text-indigo-900 text-lg' : ''}
                        ${!isActive && isRest ? 'text-orange-600' : 'text-slate-800 text-lg'}
                    ">
                        ${visitorClass} ${isActive ? '<span class="mr-2 inline-block bg-indigo-500 text-white text-[10px] px-2 py-0.5 rounded animate-pulse">×¢×›×©×™×•</span>' : ''}
                    </div>
                </div>`;
            });
            html += `</div></div>`;

            // Round B
            html += `<div class="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">`;
            html += `<div class="bg-emerald-50 px-6 py-4 font-black text-emerald-900 border-b border-emerald-100 flex items-center justify-between">
                        <span>×¡×‘×‘ ×‘' (×©×›×‘×” ×–')</span>
                        <span class="text-xs bg-white text-emerald-700 px-2 py-1 rounded-md shadow-sm">11:15 - 12:00</span>
                     </div>`;
            html += `<div class="divide-y divide-slate-100">`;
            
            scheduleData.roundB.times.forEach((time, idx) => {
                const row = scheduleData.roundB.matrix[idx];
                const classIdx = row.indexOf(stationNum);
                
                let visitorClass = "";
                let isRest = false;
                let isPack = false;
                
                const slotStart = timeToMins(time);
                const isActive = simulatedTime >= slotStart && simulatedTime < (slotStart + 10);
                
                if (idx === 3 && stationNum === 3) {
                     visitorClass = "ğŸ“¦ ×§×™×¤×•×œ, × ×™×§×™×•×Ÿ ×•×”×ª××¨×’× ×•×ª";
                     isPack = true;
                } else if (classIdx !== -1 && classIdx < 6) {
                    visitorClass = `×××¨×—×™× ××ª ${classNames['×–' + (classIdx + 1)]}`;
                } else if (row[6] === stationNum) {
                     visitorClass = "â¸ï¸ ×–××Ÿ ×”×¤×¡×§×” ×•×× ×•×—×”";
                     isRest = true;
                }

                html += `
                <div class="flex items-center p-4 transition-colors 
                    ${isActive ? 'bg-indigo-100 border-r-4 border-indigo-500 shadow-inner' : ''}
                    ${!isActive && isRest ? 'bg-orange-50/50 hover:bg-orange-50' : ''} 
                    ${!isActive && isPack ? 'bg-indigo-50/50 hover:bg-indigo-50' : ''}
                    ${!isActive && !isRest && !isPack ? 'hover:bg-slate-50' : ''}
                ">
                    <div class="w-24 font-mono font-bold text-sm ${isActive ? 'text-indigo-700 bg-white shadow-sm' : 'text-slate-500 bg-slate-100'} px-2 py-1 rounded text-center">${time}</div>
                    <div class="flex-grow font-bold px-4
                        ${isActive ? 'text-indigo-900 text-lg' : ''}
                        ${!isActive && isRest ? 'text-orange-600' : ''} 
                        ${!isActive && isPack ? 'text-indigo-600' : ''}
                        ${!isActive && !isRest && !isPack ? 'text-slate-800 text-lg' : ''}
                    ">
                        ${visitorClass} ${isActive ? '<span class="mr-2 inline-block bg-indigo-500 text-white text-[10px] px-2 py-0.5 rounded animate-pulse">×¢×›×©×™×•</span>' : ''}
                    </div>
                </div>`;
            });
             html += `</div></div></div></div>`; // Close cards and Left Col

             // Right Col (Map - Sticky on desktop)
             html += `<div class="w-full xl:w-1/3 flex-shrink-0">
                        <div class="sticky top-24">
                            ${getMapHtml(stationNum)}
                        </div>
                     </div>`;
            
            html += `</div>`; // Close layout
            container.innerHTML = html;
        }

        function renderMasterTable() {
            const tbodyA = document.getElementById('masterTableBodyA');
            scheduleData.roundA.times.forEach((time, idx) => {
                const rowData = scheduleData.roundA.matrix[idx];
                const restStation = rowData[6];
                const tr = document.createElement('tr');
                tr.className = "hover:bg-blue-50/50 transition-colors";
                tr.innerHTML = `
                    <td class="px-4 py-3 font-mono font-bold text-slate-500 border-b border-slate-100">${time}</td>
                    ${rowData.slice(0, 6).map(st => `<td class="px-4 py-3 border-b border-slate-100 font-bold text-slate-700 bg-white" title="××™×§×•×: ${stationDetails[st].location}">×ª×—× ×” ${st}</td>`).join('')}
                    <td class="px-4 py-3 font-black text-orange-600 bg-orange-50/50 border-b border-orange-100 text-center text-xs" title="${stationDetails[restStation].name}">×ª×—× ×” ${restStation}</td>
                `;
                tbodyA.appendChild(tr);
            });

            const tbodyB = document.getElementById('masterTableBodyB');
            scheduleData.roundB.times.forEach((time, idx) => {
                const rowData = scheduleData.roundB.matrix[idx];
                const restStation = rowData[6];
                let restText = `×ª×—× ×” ${restStation}`;
                if (idx === 3 && restStation === 3) restText += " (×§×™×¤×•×œ)";

                const tr = document.createElement('tr');
                tr.className = "hover:bg-emerald-50/50 transition-colors";
                tr.innerHTML = `
                    <td class="px-4 py-3 font-mono font-bold text-slate-500 border-b border-slate-100">${time}</td>
                    ${rowData.slice(0, 6).map(st => `<td class="px-4 py-3 border-b border-slate-100 font-bold text-slate-700 bg-white" title="××™×§×•×: ${stationDetails[st].location}">×ª×—× ×” ${st}</td>`).join('')}
                    <td class="px-4 py-3 font-black text-orange-600 bg-orange-50/50 border-b border-orange-100 text-center text-xs" title="${stationDetails[restStation].name}">${restText}</td>
                `;
                tbodyB.appendChild(tr);
            });
        }

        // --- Utils & Timing Calculations ---
        function timeToMins(timeStr) {
            const [hours, mins] = timeStr.split(':').map(Number);
            return hours * 60 + mins;
        }

        function updateLiveStatusAndTimer() {
            const hours = Math.floor(simulatedTime / 60);
            const minutes = simulatedTime % 60;
            const timeStr = `${hours}:${minutes < 10 ? '0'+minutes : minutes}`;

            let status = "×”×™×•× ×”×¡×ª×™×™×";
            let subStatus = "×›×œ ×”×›×‘×•×“ ×œ×›×•×œ×! × ×™×§×™×•×Ÿ ×•×©×—×¨×•×¨.";
            let colorClass = "text-slate-400";
            
            // Calculate remaining time for the active slot
            let minsRemaining = 0;
            let secsRemaining = 0;

            // Find the current main schedule block to calculate time left
            const activeSlot = generalDaySchedule.find(s => simulatedTime >= s.start && simulatedTime < s.end);
            
            if (activeSlot) {
                // Determine purimon station timing if applicable
                let slotEnd = activeSlot.end;
                
                if (activeSlot.isPurimon) {
                    // It's a 10 min slot round
                    const minsIntoRound = simulatedTime - activeSlot.start;
                    const slotsPassed = Math.floor(minsIntoRound / 10);
                    slotEnd = activeSlot.start + ((slotsPassed + 1) * 10);
                }
                
                // Calculate exact remaining
                const totalSecondsLeft = ((slotEnd - simulatedTime) * 60) - currentSeconds;
                if (totalSecondsLeft >= 0) {
                    minsRemaining = Math.floor(totalSecondsLeft / 60);
                    secsRemaining = totalSecondsLeft % 60;
                }
            }

            if (simulatedTime < 580) {
                status = "×˜×¨× ×”×ª×—×™×œ"; subStatus = "×”×›× ×•×ª ××—×¨×•× ×•×ª ×‘×‘×•×§×¨, ××ª×¨×’×©×™×!"; colorClass = "text-slate-300";
            } else if (simulatedTime >= 580 && simulatedTime < 600) {
                status = "09:40 - ×‘×•×§×¨ ×˜×•×‘"; subStatus = "× ××¦××™× ×‘×›×™×ª×•×ª, ×¨×™×©×•× × ×•×›×—×•×ª ×•×”×ª××¨×’× ×•×ª."; colorClass = "text-teal-400";
            } else if (simulatedTime >= 600 && simulatedTime < 650) {
                status = "10:00 - ×¡×‘×‘ ×' ×¤×¢×™×œ"; subStatus = "×˜' ×‘×¤×•×¨×™××•×Ÿ | ×–' ×‘××¡×™×‘×ª ××•×–× ×™×•×ª"; colorClass = "text-blue-400";
            } else if (simulatedTime >= 650 && simulatedTime < 675) {
                status = "10:50 - ×“×•×›× ×™ ××•×›×œ"; subStatus = "×›×•×œ× × ×”× ×™× ××“×•×›× ×™ ×”××•×›×œ (×’× ×—' ×‘×”×¤×¡×§×”)."; colorClass = "text-amber-400";
            } else if (simulatedTime >= 675 && simulatedTime < 720) {
                status = "11:15 - ×¡×‘×‘ ×‘' ×¤×¢×™×œ"; subStatus = "×–' ×‘×¤×•×¨×™××•×Ÿ | ×˜' ×‘××¡×™×‘×ª ××•×–× ×™×•×ª"; colorClass = "text-emerald-400";
            } else if (simulatedTime >= 720 && simulatedTime < 745) {
                status = "12:00 - × ×™×§×™×•× ×•×ª"; subStatus = "×× ×§×™× ××ª ×”×›×™×ª×•×ª + ×ª××•× ×” ×›×™×ª×ª×™×ª!"; colorClass = "text-rose-400";
            } else if (simulatedTime >= 745 && simulatedTime < 780) {
                status = "12:25 - ×›×™× ×•×¡ ×ª×—×¨×•×ª"; subStatus = "×›×•×œ× ×‘×›×™× ×•×¡ ×—×˜×™×‘×ª×™ ×œ×ª×—×¨×•×ª ×ª×—×¤×•×©×•×ª!"; colorClass = "text-fuchsia-400";
            } else if (simulatedTime >= 780 && simulatedTime < 790) {
                status = "13:00 - ×™×¦×™××”"; subStatus = "×”×¡×¢×•×ª ×‘-13:10, × ×¡×™×¢×” ×˜×•×‘×” ×•×—×’ ×©××—!"; colorClass = "text-slate-300";
            } else {
                minsRemaining = 0; secsRemaining = 0;
            }

            // Update DOM Texts
            liveStatusText.textContent = `${status} - ${subStatus}`;
            currentActivityLabel.textContent = timeStr;
            currentActivityLabel.className = `font-mono text-2xl tracking-wider font-bold ${colorClass}`;
            
            // Update Timer View
            if (simulatedTime >= 580 && simulatedTime < 790) {
                timerMinutesEl.textContent = minsRemaining.toString().padStart(2, '0');
                timerSecondsEl.textContent = secsRemaining.toString().padStart(2, '0');
                
                // Color timer red if less than 1 minute left
                if (minsRemaining === 0) {
                    timerMinutesEl.className = "font-mono text-2xl font-black text-rose-500 animate-pulse";
                    timerSecondsEl.className = "font-mono text-xl font-bold text-rose-400 animate-pulse";
                } else {
                    timerMinutesEl.className = "font-mono text-2xl font-black text-white";
                    timerSecondsEl.className = "font-mono text-xl font-bold text-slate-300";
                }
            } else {
                timerMinutesEl.textContent = "00";
                timerSecondsEl.textContent = "00";
                timerMinutesEl.className = "font-mono text-2xl font-black text-slate-600";
                timerSecondsEl.className = "font-mono text-xl font-bold text-slate-600";
            }
        }
    </script>
</body>
</html>
